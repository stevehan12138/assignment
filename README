this can still be optimized a lot, 
but I need to get this done and learn all the new concepts within a week,
so sorry for that.